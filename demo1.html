<!DOCTYPE HTML>
<!--
	Alpha by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>SSL</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	</head>
	<body class="landing is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<h1><a href="index.html">SSL</a></h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">과제 개요</a></li>
							<li><a href="results.html">결과물</a></li>
							<li>
								<a href="demo1.html" class="icon solid fa-angle-down">통합 시연</a>
								<ul>
									<li><a href="demo1.html#box1">Part 1</a></li>
									<li><a href="demo1.html#box2">Part 2</a></li>
									<li><a href="demo1.html#box3">Part 3</a></li>
									<li><a href="demo1.html#box4">Part 4</a></li>
								</ul>
							</li>
							<li><a href="demo2.html"><strong style="color:white">Downstream Task</strong></a></li>
						</ul>
					</nav>
				</header>


			<!-- Banner -->
				<section id="banner">
					<!--
					<h2>Alpha</h2>
					<p>Another fine responsive site template freebie by HTML5 UP.</p> -->
					<h5>정보통신⦁방송 기술개발사업<br/>
						차세대 인공지능 핵심원천기술개발<h5>
					<h3>자기지도학습에 의한 시각적 상식으로<br/>
						영상에서 보이지 않는 부분을 복원하는 기술</h3>
					
				</section>

			<!-- Main -->
				<section id="main" class="container">
					<ul class="actions special">
						<li><a href="index.html" class="button">과제 개요</a></li>
						<li><a href="results.html" class="button">결과물</a></li>
						<li><a href="demo1.html" class="button primary">통합 시연</a></li>
						<li><a href="demo2.html" class="button">Downstream Task</a></li>
					</ul>
					<br/>
					
					<div class="box">
						<span class="image featured"><img src="images/demo1-1.png" alt="" /></span>
						.
					</div>
					
					<!--
					<div class="box" id="button_box">
						<ul class="actions special">
							<li><a href="#box1" class="button">Part 1</a></li>
							<li><a href="#box2" class="button">Part 2</a></li>
							<li><a href="#box3" class="button">Part 3</a></li>
							<li><a href="#box4" class="button">Part 4</a></li>
						</ul>
					</div>
					-->
			
					<section class="box special features">
						<div class="features-row">
							<section>
								<a href="#box1">
									<h3>Part 1</h3>
									<p>객체의 의도, 관계성을 상식화하는 기술</p>
									</a>
							</section>
							<section>
								<a href="#box2">
								<h3>Part 2</h3>
								<p>객체의 기능, 외형, 속성 등을 상식화하는 기술</p>
								</a>
							</section>
						</div>
						<div class="features-row">
							<section>
								<a href="#box3">
								<h3>Part 3</h3>
								<p>복원될 객체의 영상 정보를 활용하여 환경과의 영상 관계를 연상 (추론)하는 기술</p>
								</a>
							</section>
							<section>
								<a href="#box4">
								<h3>Part 4</h3>
								<p>시각적 상식 기반으로 사물의 영상 형상/구조 및 색상을 복원하는 기술</p>
								</a>
							</section>
						</div>
					</section>
					
					
					<div class="box" id="box1">
						<h3>Part 1</h3>
						<p><span><img src="images/back.jpg" alt=""  style="max-width: 40%; height: auto; float: right"/></span>
						Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent.
						<br/><br/>
						<strong>이미지 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_img1" accept="image/*" onchange="setImageThumbnail(event, '#image_container1');"/>
						<br/><br/>
						<input id="submit_1" type="submit" onclick="submitData(event, '1', '10011')">
						<br/><br/>
						<h4>미리보기</h4>
						<div id="image_container1">image preview</div> 
						</p>
						
						<h4>결과</h4>
						<pre id=json_results1>json results</pre>
						
					</div>

					<div class="box" id="box2">
						<h3>Part 2</h3>
						<p><span><img src="images/back.jpg" alt=""  style="max-width: 40%; height: auto; float: right"/></span>
						Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent.
						<br/><br/>
						<strong>이미지 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_img2" accept="image/*" onchange="setImageThumbnail(event, '#image_container2');"/>
						<br/><br/>
						<strong>JSON 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_json2" accept="application/JSON" onchange="setJsonThumbnail(event, '#json_preview2')"/>
						<br/><br/>
						<input id="submit_2" type="submit" onclick="submitData(event, '2', '10021')">
						<br/><br/>
						<h4>미리보기</h4>
						<div id="image_container2"></div> 
						<pre id=json_preview2>json file preview</pre>
						</p>
						
						<h4>결과</h4>
						<pre id=json_results2>json results</pre>
						
					</div>

					<div class="box" id="box3">
						<h3>Part 3</h3>
						<p><span><img src="images/back.jpg" alt=""  style="max-width: 40%; height: auto; float: right"/></span>
						Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent.
						<br/><br/>
						<strong>JSON 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_json3" accept="application/JSON" onchange="setJsonThumbnail(event, '#json_preview3')"/>
						<br/><br/>
						<input id="submit_3" type="submit" onclick="submitData(event, '3', '10031')">
						<br/><br/>
						<h4>미리보기</h4>
						<pre id=json_preview3>json file preview</pre>
						</p>
						
						<h4>결과</h4>
						<pre id=json_results3>json results</pre>
						
					</div>
					
					<div class="box" id="box4">
						<h3>Part 4</h3>
						<p><span><img src="images/back.jpg" alt=""  style="max-width: 40%; height: auto; float: right"/></span>
						Fringilla nisl. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent. Donec accumsan interdum nisi, quis tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent tincidunt felis sagittis eget. tempus euismod. Vestibulum ante ipsum primis in faucibus vestibulum. Blandit adipiscing eu felis iaculis volutpat ac adipiscing accumsan eu faucibus. Integer ac pellentesque praesent.
						<br/><br/>
						<strong>이미지 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_img4" accept="image/*" onchange="setImageThumbnail(event, '#image_container4');"/>
						<br/><br/>
						<strong>JSON 파일 : &nbsp;&nbsp;&nbsp;</strong>
						<input type="file" id="file_json4" accept="application/JSON" onchange="setJsonThumbnail(event, '#json_preview4')"/>
						<br/><br/>
						<input id="submit_4" type="submit" onclick="submitData(event, '4', '10041')">
						<br/><br/>
						<h4>미리보기</h4>
						<div id="image_container4"></div> 
						<pre id=json_preview4>json file preview</pre>
						</p>
						
						<h4>결과</h4>
						<pre id=json_results4>json results</pre>
						
					</div>
					
					
					
					<b>Buttons for test</b><br/>

					<button type="submit" id="dockerget">Docker GET TEST</button><br/><br/>
					<p id="show"></p>
					
					<script>
						function setImageThumbnail(event, image_area) {
							var reader = new FileReader(); 
							reader.onload = function(event) { 
								var img = document.createElement("img"); 
								img.setAttribute("src", event.target.result); 
								img.setAttribute("style", "max-width: 100%; height: auto;");
								$(image_area).empty();
								document.querySelector(image_area).appendChild(img); 
							}; 
							reader.readAsDataURL(event.target.files[0]); 
						}

						function setJsonThumbnail(event, json_area) {
							var reader = new FileReader(); 
							reader.onload = function(event) { 
								$(json_area).html("");
								$(json_area).html(event.target.result);
							};
							reader.readAsText(event.target.files[0]);
						}

						// ex) submitData(event, '1', '10011', 'image_contents', '')
						function submitData(event, num, port_num) {
							input_url = "http://127.0.0.1:" + port_num + "/api/run"
							// 127.0.0.1

							var hasImage = false;
							var hasJson = false;
							var readerImg = new FileReader();
							var readerJson = new FileReader();

							if (num == 1 || num == 2 || num == 4) {
								hasImage = true;
								alertIfFileNotSelected(readerImg, "file_img", num);
							}
							if (num == 2 || num == 3 || num == 4) {
								hasJson = true;
								alertIfFileNotSelected(readerJson, "file_json", num);
							}

							var jsonArray = new Object();
							var base64image;

							if(hasImage && hasJson) {
								readerImg.onload = function() {
									readerJson.onload = function() {
										$('#json_results'+num).html("loading...");
										base64image = getBase64Image(readerImg);
										jsonArray['image_contents'] = base64image;
										
										var jsonData = JSON.parse(readerJson.result);
										jsonArray['scene_graph'] = jsonData;

										jsonArray = JSON.stringify(jsonArray);
										postData(input_url, jsonArray, num);
									}
								}
							}
							else if(hasImage) {
								readerImg.onload = function() {
									$('#json_results'+num).html("loading...");
									base64image = getBase64Image(readerImg);
									jsonArray['image_contents'] = base64image;

									jsonArray = JSON.stringify(jsonArray);
									postData(input_url, jsonArray, num);
								}
							}
							else if(hasJson) {
								readerJson.onload = function() {
									$('#json_results'+num).html("loading...");
									var jsonData = JSON.parse(readerJson.result);
									jsonArray['scene_graph'] = jsonData;

									jsonArray = JSON.stringify(jsonArray);
									postData(input_url, jsonArray, num);
								}
							}
						}

						function alertIfFileNotSelected(reader, file, num) {
							if (file == "file_img") {
								var img = document.getElementById("file_img"+num).files[0];
								try {
									reader.readAsDataURL(img);
								}
								catch(err) {
									alert("이미지를 선택하세요.");
								}
							}
							else {
								var json = document.getElementById("file_json"+num).files[0];
								try {
									reader.readAsText(json);
								}
								catch(err) {
									alert("JSON 파일을 선택하세요.");
								}
							}
						}

						function getBase64Image(reader) {
							var base64image = reader.result;
							var commaIndex = base64image.indexOf(",");
							base64image = base64image.slice(commaIndex+1);
							return base64image;
						}

						function postData(input_url, jsonArray, num) {
							$.ajax({
								type: "POST",
								url: input_url,
								data: jsonArray,
								success:function(data){
									if(num == "1" || num == "4") {
										var obj = JSON.parse(data);
										var resultImage = document.createElement("img");
										resultImage.setAttribute("src", 'data:image/png;base64,' + obj.image_contents); 
										resultImage.setAttribute("style", "max-width: 100%; height: auto;"); 
										$('#image_container'+num).empty();
										document.querySelector('#image_container'+num).appendChild(resultImage); 
										var resultJson = obj.scene_graph;
										$('#json_results'+num).html("");
										$('#json_results'+num).html(resultJson);
									}
									else {
										$('#json_results'+num).html(data);
									}
								},
								error:function(data){
									//$('#json_results'+num).html(JSON.stringify(data));
									alert(JSON.stringify(data));
								}
							});
						}

						// docker GET
						$(function(){
						  $('#dockerget').click(function(){
							$('#show').html('....loading...');
							
							$.ajax({
								type: "GET",
								url: "http://127.0.0.1:10011/api/task_name",
								success:function(data){
									$('#show').html(JSON.stringify(data));
								},
								error:function(){
									alert('GET Failure')
								}
							})
						  })
						})

						/*
						POST 주소들
						Part 1 - POSTECH (10011)
						url: "http://127.0.0.1:10011/api/run",
						data: JSON.stringify({'image_contents' : base64image})
						
						Part 2 - Birmingham (10021)
						url: "http://127.0.0.1:10021/api/run",
						data: JSON.stringify({'image_contents' : base64image, 'scene_graph': 'json_data'})
						
						Part 2 - UNIST (10022)
						url: "http://127.0.0.1:10022/api/run",
						data: JSON.stringify({'image_contents' : base64image, 'scene_graph': 'json_data'})
						
						Part 3 - KAIST (10032)
						url: "http://127.0.0.1:10032/api/run",
						data: JSON.stringify({'scene_graph': 'json_data'})
						
						Part 3 - KETI (10031)
						url: "http://127.0.0.1:10031/api/run",
						data: JSON.stringify({'scene_graph': 'json_data'})
						
						Part 4 - POSTECH (10041)
						url: "http://127.0.0.1:10041/api/run",
						data: JSON.stringify({'image_contents' : base64image, 'scene_graph': 'json_data'})
						단, 이미지 파일이 선택되어있어야 에러 안남

						Part 4 - SNU (10042)
						url: "http://127.0.0.1:10042/api/run",
						data: JSON.stringify({'image_contents' : base64image, 'scene_graph': 'json_data'})
						단, 이미지 파일이 선택되어있어야 에러 안남
						*/
					</script>
					
				</section>
				
				
			<!-- Footer -->
				<footer id="footer">
					<ul class="copyright">
						<li>&copy; KETI. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</footer>

		</div>
				
		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.dropotron.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
	</body>
</html>